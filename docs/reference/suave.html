<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Integration with SUbregion-Adaptive Vegas Algorithm — suave • cubature</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Integration with SUbregion-Adaptive Vegas Algorithm — suave" />

<meta property="og:description" content="Suave uses vegas-like importance sampling combined with a
globally adaptive subdivision strategy: Until the requested accuracy is
reached, the region with the largest error at the time is bisected in the
dimension in which the fluctuations of the integrand are reduced most. The
number of new samples in each half is prorated for the fluctuation in that
half." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cubature</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cubature.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Integration with SUbregion-Adaptive Vegas Algorithm</h1>
    
    <div class="hidden name"><code>suave.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Suave uses <code><a href='vegas.html'>vegas</a></code>-like importance sampling combined with a
globally adaptive subdivision strategy: Until the requested accuracy is
reached, the region with the largest error at the time is bisected in the
dimension in which the fluctuations of the integrand are reduced most. The
number of new samples in each half is prorated for the fluctuation in that
half.</p>
    
    </div>

    <pre class="usage"><span class='fu'>suave</span>(<span class='no'>f</span>, <span class='kw'>nComp</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='no'>lowerLimit</span>, <span class='no'>upperLimit</span>, <span class='no'>...</span>, <span class='kw'>relTol</span> <span class='kw'>=</span> <span class='fl'>1e-05</span>,
  <span class='kw'>absTol</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>minEval</span> <span class='kw'>=</span> <span class='fl'>0L</span>, <span class='kw'>maxEval</span> <span class='kw'>=</span> <span class='fl'>10</span>^<span class='fl'>6</span>, <span class='kw'>flags</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>final</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>smooth</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>keep_state</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>load_state</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>rngSeed</span> <span class='kw'>=</span>
  <span class='fl'>12345L</span>), <span class='kw'>nVec</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>nNew</span> <span class='kw'>=</span> <span class='fl'>1000L</span>, <span class='kw'>nMin</span> <span class='kw'>=</span> <span class='fl'>50L</span>, <span class='kw'>flatness</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>stateFile</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>f</th>
      <td><p>The function (integrand) to be integrated. Optionally, the
function can take two additional arguments in addition to the
variable being integrated: - <code>cuba_weight</code> which is the
weight of the point being sampled, - <code>cuba_iter</code> the
current iteration number. The function may choose to use these
in any appropriate way or ignore them altogether</p></td>
    </tr>
    <tr>
      <th>nComp</th>
      <td><p>The number of components of the integrand, default 1,
bears no relation to the dimension of the hypercube over which
integration is performed</p></td>
    </tr>
    <tr>
      <th>lowerLimit</th>
      <td><p>The lower limit of integration, a vector for
hypercubes</p></td>
    </tr>
    <tr>
      <th>upperLimit</th>
      <td><p>The upper limit of integration, a vector for
hypercubes</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>All other arguments passed to the function f</p></td>
    </tr>
    <tr>
      <th>relTol</th>
      <td><p>The maximum tolerance, default 1e-5.</p></td>
    </tr>
    <tr>
      <th>absTol</th>
      <td><p>the absolute tolerance, default 0.</p></td>
    </tr>
    <tr>
      <th>minEval</th>
      <td><p>the minimum number of function evaluations required</p></td>
    </tr>
    <tr>
      <th>maxEval</th>
      <td><p>The maximum number of function evaluations needed,
default 10^6.  Note that the actual number of function
evaluations performed is only approximately guaranteed not to
exceed this number.</p></td>
    </tr>
    <tr>
      <th>flags</th>
      <td><p>flags governing the integration. A list with
components: - <code>verbose</code>: <code>verbose</code> encodes the
verbosity level, from 0 (default) to 3.  Level 0 does not print
any output, level 1 prints &#8220;reasonable&#8221; information on
the progress of the integration, levels 2 and 3 echo the input
parameters.  - <code>final</code>: when <code> 0</code>, all sets of
samples collected on a subregion during the various iterations
or phases contribute to the final result.  When <code> 1</code>, only
the last (largest) set of samples is used in the final result.
- <code>smooth</code>. When <code>smooth = 0</code>, apply additional
smoothing to the importance function, this moderately improves
convergence for many integrands.  When <code>smooth = 1</code> , use
the importance function without smoothing, this should be
chosen if the integrand has sharp edges.  - <code>keep_state</code>:
when nonzero, retain state file if argument <code>stateFile</code> is
non-null.  - <code>load_state</code>: when zero, load state file if
found; if nonzero, reset state regardless - <code>level</code>: when
<code>0</code>, Mersenne Twister random numbers are used. When
nonzero Ranlux random numbers are used.  - <code>rngSeed</code>: When
zero, Sobol quasi-random numbers are used for
sampling. Otherwise the seed is used for the generator
indicated by <code>level</code>.</p></td>
    </tr>
    <tr>
      <th>nVec</th>
      <td><p>the number of vectorization points, default 1, but can
be set to an integer &gt; 1 for vectorization, for example, 1024
and the function f above needs to handle the vector of points
appropriately</p></td>
    </tr>
    <tr>
      <th>nNew</th>
      <td><p>the number of new integrand evaluations in each
subdivision.</p></td>
    </tr>
    <tr>
      <th>nMin</th>
      <td><p>the minimum number of samples a former pass must
contribute to a subregion to be considered in that region’s
compound integral value. Increasing nmin may reduce jumps in
the \(\Chi^2\) value.</p></td>
    </tr>
    <tr>
      <th>flatness</th>
      <td><p>the parameter p, or the type of norm used to
compute the fluctuation of a sample. This determines how
prominently ‘outliers,’ i.e. individual samples with a large
fluctuation, figure in the total fluctuation, which in turn
determines how a region is split up. As suggested by its name,
flatness should be chosen large for ‘flat’ integrands and small
for ‘volatile’ integrands with high peaks. Note that since
flatness appears in the exponent, one should not use too large
values (say, no more than a few hundred) lest terms be
truncated internally to prevent overflow.</p></td>
    </tr>
    <tr>
      <th>stateFile</th>
      <td><p>the name of an external file. Suave can store its
entire internal state (i.e. all the information to resume an
interrupted integration) in an external file.</p>
<p>The state file is updated after every iteration. If, on a subsequent
invocation, Suave finds a file of the specified name, it loads the internal
state and continues from the point it left off. Needless to say, using an
existing state file with a different integrand generally leads to wrong
results. Once the integration finishes successfully, i.e. the prescribed
accuracy is attained, the state file is removed. This feature is useful
mainly to define &#8216;check-points&#8217; in long-running integrations from
which the calculation can be restarted.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with components:</p>
<dt>neval </dt><dd><p>the actual number of integrand evaluations needed</p></dd>
<dt>returnCode</dt><dd><p>return code: <code>0</code> , the desired accuracy was
reached, <code>-1</code>, dimension out of range, <code>1</code>, the accuracy
goal was not met within the allowed maximum number of integrand
evaluations.</p></dd>  itemintegralvector of length <code>nComp</code>; the
integral of <code>integrand</code> over the hypercube.
<dt>error</dt><dd><p>vector of length <code>nComp</code>; the presumed absolute
error of <code>integral</code></p></dd> <dt>prob</dt><dd><p>vector of length
<code>nComp</code>; the \($\chi^2$\)-probability (not the
\($\chi^2$\)-value itself!) that <code>error</code> is not a
reliable estimate of the true integration error.</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See details in the documentation.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>T. Hahn (2005) CUBA-a library for multidimensional numerical
integration. <em>Computer Physics Communications</em>, <b>168</b>, 78-95.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cuhre.html'>cuhre</a></code>, <code><a href='divonne.html'>divonne</a></code>, <code><a href='vegas.html'>vegas</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>integrand</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>arg</span>) {
  <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>arg</span>[<span class='fl'>1</span>]
  <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>arg</span>[<span class='fl'>2</span>]
  <span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='no'>arg</span>[<span class='fl'>3</span>]
  <span class='no'>ff</span> <span class='kw'>&lt;-</span> <span class='fu'>sin</span>(<span class='no'>x</span>)*<span class='fu'>cos</span>(<span class='no'>y</span>)*<span class='fu'>exp</span>(<span class='no'>z</span>);
<span class='fu'>return</span>(<span class='no'>ff</span>)
} <span class='co'># end integrand</span>
<span class='fu'>suave</span>(<span class='no'>integrand</span>, <span class='kw'>lowerLimit</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fl'>3</span>), <span class='kw'>upperLimit</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span>, <span class='fl'>3</span>),
             <span class='kw'>relTol</span><span class='kw'>=</span><span class='fl'>1e-3</span>,  <span class='kw'>absTol</span><span class='kw'>=</span><span class='fl'>1e-12</span>,
             <span class='kw'>flags</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>final</span><span class='kw'>=</span><span class='fl'>0</span>))</div><div class='output co'>#&gt; $integral
#&gt; [1] 0.6641147
#&gt; 
#&gt; $error
#&gt; [1] 0.0006573267
#&gt; 
#&gt; $neval
#&gt; [1] 56000
#&gt; 
#&gt; $prob
#&gt; [1] 1
#&gt; 
#&gt; $returnCode
#&gt; [1] 0
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://statistics.stanford.edu/people/balasubramanian-narasimhan'>Balasubramanian Narasimhan</a>, <a href='https://math.mit.edu/~stevenj/'>Steven G. Johnson</a>, <a href='https://wwwth.mpp.mpg.de/members/hahn/'>Thomas Hahn</a>, Annie Bouvier,  Kiên Kiêu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

