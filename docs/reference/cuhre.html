<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Integration by a Deterministic Iterative Adaptive Algorithm — cuhre • cubature</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Integration by a Deterministic Iterative Adaptive Algorithm — cuhre" />
<meta property="og:description" content="Implement a deterministic algorithm for multidimensional numerical
integration. Its algorithm uses one of several cubature rules in a globally
adaptive subdivision scheme.  The subdivision algorithm is similar to
suave's." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cubature</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cubature.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/version2.html">Version 2.0 Notes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bnaras/cubature/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Integration by a Deterministic Iterative Adaptive Algorithm</h1>
    <small class="dont-index">Source: <a href='https://github.com/bnaras/cubature/blob/master/R/cuhre.R'><code>R/cuhre.R</code></a></small>
    <div class="hidden name"><code>cuhre.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implement a deterministic algorithm for multidimensional numerical
integration. Its algorithm uses one of several cubature rules in a globally
adaptive subdivision scheme.  The subdivision algorithm is similar to
<code><a href='suave.html'>suave</a></code>'s.</p>
    </div>

    <pre class="usage"><span class='fu'>cuhre</span><span class='op'>(</span>
  <span class='va'>f</span>,
  nComp <span class='op'>=</span> <span class='fl'>1L</span>,
  <span class='va'>lowerLimit</span>,
  <span class='va'>upperLimit</span>,
  <span class='va'>...</span>,
  relTol <span class='op'>=</span> <span class='fl'>1e-05</span>,
  absTol <span class='op'>=</span> <span class='fl'>1e-12</span>,
  minEval <span class='op'>=</span> <span class='fl'>0L</span>,
  maxEval <span class='op'>=</span> <span class='fl'>10</span><span class='op'>^</span><span class='fl'>6</span>,
  flags <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>verbose <span class='op'>=</span> <span class='fl'>0L</span>, final <span class='op'>=</span> <span class='fl'>1L</span>, keep_state <span class='op'>=</span> <span class='fl'>0L</span>, level <span class='op'>=</span> <span class='fl'>0L</span><span class='op'>)</span>,
  key <span class='op'>=</span> <span class='fl'>0L</span>,
  nVec <span class='op'>=</span> <span class='fl'>1L</span>,
  stateFile <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>f</th>
      <td><p>The function (integrand) to be integrated. For cuhre, it
can be something as simple as a function of a single argument,
say x.</p></td>
    </tr>
    <tr>
      <th>nComp</th>
      <td><p>The number of components of f, default 1, bears no
relation to the dimension of the hypercube over which
integration is performed.</p></td>
    </tr>
    <tr>
      <th>lowerLimit</th>
      <td><p>The lower limit of integration, a vector for
hypercubes.</p></td>
    </tr>
    <tr>
      <th>upperLimit</th>
      <td><p>The upper limit of integration, a vector for
hypercubes.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>All other arguments passed to the function f.</p></td>
    </tr>
    <tr>
      <th>relTol</th>
      <td><p>The maximum tolerance, default 1e-5.</p></td>
    </tr>
    <tr>
      <th>absTol</th>
      <td><p>the absolute tolerance, default 1e-12.</p></td>
    </tr>
    <tr>
      <th>minEval</th>
      <td><p>the minimum number of function evaluations required</p></td>
    </tr>
    <tr>
      <th>maxEval</th>
      <td><p>The maximum number of function evaluations needed,
default 10^6.  Note that the actual number of function
evaluations performed is only approximately guaranteed not to
exceed this number.</p></td>
    </tr>
    <tr>
      <th>flags</th>
      <td><p>flags governing the integration. The list here is
exhaustive to keep the documentation and invocation uniform,
but not all flags may be used for a particular method as noted
below.  List components:</p><dl>
<dt><code>verbose</code></dt><dd><p>encodes the verbosity level, from 0 (default) to 3.  Level 0
does not print any output, level 1 prints reasonable
information on the progress of the integration, level 2 also
echoes the input parameters, and level 3 further prints the
subregion results.</p></dd>  <dt><code>final</code></dt><dd><p>when 0, all sets of
samples collected on a subregion during the various iterations
or phases contribute to the final result.  When 1, only the
last (largest) set of samples is used in the final result.</p></dd>
<dt><code>smooth</code></dt><dd><p>Applies to Suave and Vegas only. When 0,
apply additional smoothing to the importance function, this
moderately improves convergence for many integrands.  When 1,
use the importance function without smoothing, this should be
chosen if the integrand has sharp edges.</p></dd>
<dt><code>keep_state</code></dt><dd><p>when nonzero, retain state file if
argument <code>stateFile</code> is non-null, else delete
<code>stateFile</code> if specified.</p></dd>
<dt><code>load_state</code></dt><dd><p>Applies to Vegas only. Reset the
integrator's state even if a state file is present, i.e. keep
only the grid. Together with <code>keep_state</code> this allows a
grid adapted by one integration to be used for another
integrand.</p></dd>  <dt><code>level</code></dt><dd><p>applies only to Divonne, Suave
and Vegas. When <code>0</code>, Mersenne Twister random numbers are
used. When nonzero Ranlux random numbers are used, except when
<code>rngSeed</code> is zero which forces use of Sobol quasi-random
numbers. Ranlux implements Marsaglia and Zaman's 24-bit RCARRY
algorithm with generation period p, i.e. for every 24 generated
numbers used, another p-24 are skipped. The luxury level for
the Ranlux generator may be encoded in <code>level</code> as follows:
<dl>
<dt>Level 1 (p = 48)</dt><dd><p>gives very long period,
passes the gap test but fails spectral test</p></dd> <dt>Level 2 (p =
97)</dt><dd><p>passes all known tests, but theoretically still defective</p></dd>
<dt>Level 3 (p = 223)</dt><dd><p>any theoretically possible
correlations have very small chance of being observed</p></dd>
<dt>Level 4 (p = 389)</dt><dd><p>highest possible luxury, all 24 bits
chaotic</p></dd> <dt>Levels 5-23</dt><dd><p>default to 3, values above 24
directly specify the period p.</p></dd>
</dl>  Note that Ranlux's original
level 0, (mis)used for selecting Mersenne Twister in Cuba, is
equivalent to <code>level</code> = 24.</p></dd>
</dl></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>the quadrature rule key: <code>key = 7, 9, 11, 13</code>
selects the cubature rule of degree key. Note that the
degree-11 rule is available only in 3 dimensions, the degree-13
rule only in 2 dimensions.  For other values, including the
default 0, the rule is the degree-13 rule in 2 dimensions, the
degree-11 rule in 3 dimensions, and the degree-9 rule
otherwise.</p></td>
    </tr>
    <tr>
      <th>nVec</th>
      <td><p>the number of vectorization points, default 1, but can
be set to an integer &gt; 1 for vectorization, for example, 1024
and the function f above needs to handle the vector of points
appropriately. See vignette examples.</p></td>
    </tr>
    <tr>
      <th>stateFile</th>
      <td><p>the name of an external file. Vegas can store its
entire internal state (i.e. all the information to resume an
interrupted integration) in an external file.  The state file
is updated after every iteration. If, on a subsequent
invocation, Vegas finds a file of the specified name, it loads
the internal state and continues from the point it left
off. Needless to say, using an existing state file with a
different integrand generally leads to wrong results. Once the
integration finishes successfully, i.e. the prescribed accuracy
is attained, the state file is removed. This feature is useful
mainly to define &#8216;check-points&#8217; in long-running
integrations from which the calculation can be restarted.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with components:</p><dl>
 <dt>neval</dt><dd><p>the actual
number of integrand evaluations needed</p></dd> <dt>returnCode</dt><dd><p>if
zero, the desired accuracy was reached, if -1, dimension out of
range, if 1, the accuracy goal was not met within the allowed
maximum number of integrand evaluations.</p></dd>
<dt>integral</dt><dd><p>vector of length <code>nComp</code>; the integral of
<code>integrand</code> over the hypercube</p></dd> <dt>error</dt><dd><p>vector of
length <code>nComp</code>; the presumed absolute error of
<code>integral</code></p></dd> <dt>prob</dt><dd><p>vector of length <code>nComp</code>; the
\(\chi^2\)-probability (not the
\(\chi^2\)-value itself!) that <code>error</code> is not a
reliable estimate of the true integration error.</p></dd>
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See details in the documentation.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>J. Berntsen, T. O. Espelid (1991) An adaptive algorithm for the
approximate calculation of multiple integrals. <em>ACM Transactions on
Mathematical Software</em>, <b>17</b>(4), 437-451.</p>
<p>T. Hahn (2005) CUBA-a library for multidimensional numerical integration.
<em>Computer Physics Communications</em>, <b>168</b>, 78-95.</p>
<p>See <a href='http://www.feynarts.de/cuba/'>http://www.feynarts.de/cuba/</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='vegas.html'>vegas</a></code>, <code><a href='suave.html'>suave</a></code>, <code><a href='divonne.html'>divonne</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>integrand</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>arg</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>arg</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>arg</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
  <span class='va'>z</span> <span class='op'>&lt;-</span> <span class='va'>arg</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>
  <span class='va'>ff</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>;
<span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>ff</span><span class='op'>)</span>
<span class='op'>}</span> <span class='co'># End integrand</span>

<span class='va'>NDIM</span> <span class='op'>&lt;-</span> <span class='fl'>3</span>
<span class='va'>NCOMP</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='fu'>cuhre</span><span class='op'>(</span>f <span class='op'>=</span> <span class='va'>integrand</span>,
      lowerLimit <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>NDIM</span><span class='op'>)</span>,
      upperLimit <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>NDIM</span><span class='op'>)</span>,
      relTol <span class='op'>=</span> <span class='fl'>1e-3</span>, absTol<span class='op'>=</span> <span class='fl'>1e-12</span>,
      flags <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>verbose <span class='op'>=</span> <span class='fl'>2</span>, final <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $integral
#&gt; [1] 0.6646697
#&gt; 
#&gt; $error
#&gt; [1] 3.330168e-11
#&gt; 
#&gt; $nregions
#&gt; [1] 2
#&gt; 
#&gt; $neval
#&gt; [1] 381
#&gt; 
#&gt; $prob
#&gt; [1] 0
#&gt; 
#&gt; $returnCode
#&gt; [1] 0
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://statistics.stanford.edu/people/balasubramanian-narasimhan'>Balasubramanian Narasimhan</a>, <a href='https://math.mit.edu/~stevenj/'>Steven G. Johnson</a>, <a href='https://wwwth.mpp.mpg.de/members/hahn/'>Thomas Hahn</a>, Annie Bouvier, Kiên Kiêu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


